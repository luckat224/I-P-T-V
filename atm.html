<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Bộ chuyển tiền - Bội số 50.000₫</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1117;--accent:#06b6d4;--muted:#94a3b8;--glass: rgba(255,255,255,0.03)}
    *{box-sizing:border-box;font-family:Inter,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{margin:0;min-height:100vh;background:linear-gradient(180deg,#071026 0%, #022635 100%);color:#e6eef6;display:flex;align-items:center;justify-content:center;padding:24px}
    .wrap{width:420px;max-width:96%;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);border-radius:12px;padding:20px;border:1px solid rgba(255,255,255,0.04);box-shadow:0 10px 30px rgba(2,6,23,0.6)}
  h1{font-size:18px;margin:0 0 12px;color:var(--accent)}
    .display{background:var(--glass);padding:14px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);display:flex;justify-content:space-between;align-items:center}
    .display .value{font-size:20px;font-weight:700}
    /* emphasized input amount */
    .display .value{
      font-size:28px;
      font-weight:900;
      color:#062025;
      background:linear-gradient(90deg,#fde68a,#f59e0b);
      padding:8px 14px;
      border-radius:12px;
      box-shadow:0 10px 30px rgba(245,158,11,0.12);
      transition:transform 160ms ease,box-shadow 160ms ease,opacity 160ms ease;
      text-align:left;
      min-width:160px;
    }
    .display .value.input-pulse{transform:scale(1.04);box-shadow:0 18px 44px rgba(245,158,11,0.18)}
    .display .sub{font-size:12px;color:var(--muted)}
    .pad{margin-top:12px;display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
    button.key{padding:14px;border-radius:8px;border:0;background:#0c1720;color:#e6eef6;font-size:18px;cursor:pointer;box-shadow:inset 0 -2px 0 rgba(0,0,0,0.2)}
    button.key:active{transform:translateY(1px)}
    .controls{display:flex;gap:8px;margin-top:10px}
    .controls button{flex:1;padding:10px;border-radius:8px;border:0;background:#0a2a2e;color:#e6eef6;cursor:pointer}
    .results{margin-top:16px;background:linear-gradient(180deg,rgba(255,255,255,0.015),transparent);padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.03)}
    .row{display:flex;justify-content:space-between;align-items:center;padding:6px 0}
    .label{color:var(--muted);font-size:13px}
    .amount{font-weight:700}

    /* Highlighted transfer amount styles */
    #transferAmount{
      font-size:28px;
      font-weight:900;
      color:#062025; /* dark text on bright pill */
      background:linear-gradient(90deg,var(--accent),#0ea5b0);
      padding:8px 14px;
      border-radius:12px;
      box-shadow:0 8px 24px rgba(6,182,212,0.16);
      transition:transform 160ms ease,box-shadow 160ms ease,opacity 160ms ease;
      transform-origin:center;
      min-width:140px;
      text-align:right;
    }
    /* pulse effect when value changes */
    #transferAmount.pulse{transform:scale(1.06);box-shadow:0 14px 36px rgba(6,182,212,0.22)}

    /* make sure leftAmount remains readable but secondary */
    #leftAmount{font-size:16px;color:#e6eef6}

    /* green pill to highlight top-up amount */
    .pill-green{
      display:inline-block;
      padding:8px 14px;
      background:linear-gradient(90deg,#10b981,#34d399);
      color:#042617;
      font-weight:800;
      border-radius:12px;
      box-shadow:0 10px 28px rgba(16,185,129,0.14);
      min-width:110px;
      text-align:right;
    }
    .pill-green.highlight{
      box-shadow:0 18px 48px rgba(16,185,129,0.26);
      transform:translateY(-2px);
    }

    /* small pill used for hints (styled like transferAmount but smaller) */
    .pill-small{
      display:inline-block;
      font-size:13px;
      font-weight:800;
      color:#062025;
      background:linear-gradient(90deg,var(--accent),#0ea5b0);
      padding:6px 10px;
      border-radius:10px;
      box-shadow:0 8px 20px rgba(6,182,212,0.12);
      margin-bottom:6px;
      text-align:right;
      min-width:160px;
    }

  .transfer-inline{font-weight:800;color:#e6eef6;background:transparent;border-radius:8px;padding:2px 6px}

    @media (max-width:420px){
      .wrap{padding:12px}
      #transferAmount{font-size:22px;min-width:110px;padding:10px 12px}
      #leftAmount{font-size:14px}
    }
    @media (max-width:420px){.wrap{padding:12px}}
  </style>
</head>
<body>
  <div class="wrap">
  <!-- title removed per user request -->

      <div class="display">
      <div>
        <div class="sub">Số tiền nhập</div>
        <div class="value" id="displayValue">0 ₫</div>
      </div>
    </div>

    <div class="pad" id="pad">
      <!-- keys generated by JS -->
    </div>

    <div class="controls">
      <button id="backBtn">⌫</button>
    </div>

    <div class="results">
      <div class="row">
        <div class="label">SỐ TIỀN CÓ THỂ RÚT</div>
        <div class="amount" id="transferAmount">0 ₫</div>
      </div>
      <div class="row">
        <div class="label">Còn dư</div>
        <div class="amount" id="leftAmount">0 ₫</div>
      </div>
      <div class="row">
        <div class="label">Nạp thêm</div>
        <div style="text-align:right">
          <div class="amount" id="topUpNeeded"><span class="pill-green">0 ₫</span></div>
        </div>
      </div>
      <div class="row">
        <div class="label"></div>
        <div style="text-align:right" id="topUpSentence" class="amount" aria-live="polite">
          <!-- will be filled by JS: example "[pill] để rút được 150.000 ₫" -->
        </div>
      </div>
    </div>
  </div>

  <script>
  // Giá trị lưu trong số nguyên (VND)
  let value = 0;
  // previous transfer value to detect changes (for animation)
  let prevTransfer = 0;
  // previous input value to animate input when it changes
  let prevValue = 0;

    const displayValue = document.getElementById('displayValue');
  const transferAmountEl = document.getElementById('transferAmount');
  const leftAmountEl = document.getElementById('leftAmount');
  const topUpNeededEl = document.getElementById('topUpNeeded');
  const topUpSentenceEl = document.getElementById('topUpSentence');
  const pad = document.getElementById('pad');
    const backBtn = document.getElementById('backBtn');

    // Format VND nicely (vi-VN) and append ₫
    function formatVND(n){
      try{
        return n.toLocaleString('vi-VN') + ' ₫';
      }catch(e){
        // fallback
        return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, '.') + ' ₫';
      }
    }

    function updateDisplay(){
  // update displayed input amount
  displayValue.textContent = formatVND(value);

      // pulse input display when changed
      if(value !== prevValue){
        displayValue.classList.add('input-pulse');
        if(displayValue._pulseTimer) clearTimeout(displayValue._pulseTimer);
        displayValue._pulseTimer = setTimeout(()=>{ displayValue.classList.remove('input-pulse'); displayValue._pulseTimer = null; }, 220);
      }
      prevValue = value;

      updateResults();
    }

    function updateResults(){
      const reserve = 50000; // luôn chừa 50k
      let transfer = 0;
      if(value > reserve){
        transfer = Math.floor((value - reserve) / reserve) * reserve;
        // ensure non-negative
        if(transfer < 0) transfer = 0;
      } else {
        transfer = 0;
      }
      const left = value - transfer;
      // update elements
      transferAmountEl.textContent = formatVND(transfer);
      leftAmountEl.textContent = formatVND(left);

      // compute top-up needed to reach the next withdraw level (increase withdrawable by one reserve)
      const nextTransfer = transfer + reserve;
      // minimal X >= 0 such that (value + X - reserve) >= nextTransfer
      const needed = Math.max(0, nextTransfer - Math.max(0, value - reserve));
      const topUp = needed;
      // show top-up inside green pill; if topUp equals reserve, display 0 ₫ per preference
      const displayTopUp = (topUp === reserve) ? 0 : topUp;
  const pillClass = (value === 0) ? 'pill-green highlight' : 'pill-green';
  topUpNeededEl.innerHTML = `<span class="${pillClass}">${formatVND(displayTopUp)}</span>`;
      // update sentence: show pill and the next withdrawable amount
      if(topUpSentenceEl){
        // show the sentence only when user has entered a value AND a top-up is required
        if(value > 0 && topUp > 0){
          topUpSentenceEl.innerHTML = `<span style="margin-left:8px;color:#e6eef6">để rút được</span> <span class="transfer-inline">${formatVND(nextTransfer)}</span>`;
        } else {
          topUpSentenceEl.innerHTML = '';
        }
      }

      // if transfer changed, pulse the element briefly to draw attention
      if(transfer !== prevTransfer){
        transferAmountEl.classList.add('pulse');
        // clear any existing timer
        if(transferAmountEl._pulseTimer) clearTimeout(transferAmountEl._pulseTimer);
        transferAmountEl._pulseTimer = setTimeout(()=>{ transferAmountEl.classList.remove('pulse'); transferAmountEl._pulseTimer = null; }, 220);
      }
      prevTransfer = transfer;
    }

    // create numeric pad
    const keys = ['1','2','3','4','5','6','7','8','9','0'];
    keys.forEach(k=>{
      const btn = document.createElement('button');
      btn.className = 'key';
      btn.textContent = k;
      btn.addEventListener('click', ()=>{ appendDigit(k); });
      pad.appendChild(btn);
    });

    function appendDigit(d){
      // prevent too many digits (safety)
      if(value.toString().length >= 15) return;
      value = value * 10 + Number(d);
      updateDisplay();
    }

    backBtn.addEventListener('click', ()=>{ value = Math.floor(value/10); updateDisplay(); });
  // full-clear removed per user request; only single-digit backspace remains

    // paste functionality removed per user request

    // keyboard support
    window.addEventListener('keydown', (ev)=>{
      if(ev.key >= '0' && ev.key <= '9'){
        appendDigit(ev.key);
        ev.preventDefault();
      } else if(ev.key === 'Backspace'){
        value = Math.floor(value/10); updateDisplay(); ev.preventDefault();
      }
    });

    // initialize
    updateDisplay();
  </script>
</body>
</html>
